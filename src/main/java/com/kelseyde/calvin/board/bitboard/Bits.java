package com.kelseyde.calvin.board.bitboard;

/**
 * Common bitboards stored here for general utility. Includes bitboards for ranks, files, diagonals, anti-diagonals,
 * castling masks, piece starting positions, etc.
 */
public class Bits {

    public static final long ALL_SQUARES = ~0L;

    public static final long RANK_1 = 0b0000000000000000000000000000000000000000000000000000000011111111L;
    public static final long RANK_2 = BitboardUtils.shiftNorth(RANK_1);
    public static final long RANK_3 = BitboardUtils.shiftNorth(RANK_2);
    public static final long RANK_4 = BitboardUtils.shiftNorth(RANK_3);
    public static final long RANK_5 = BitboardUtils.shiftNorth(RANK_4);
    public static final long RANK_6 = BitboardUtils.shiftNorth(RANK_5);
    public static final long RANK_7 = BitboardUtils.shiftNorth(RANK_6);
    public static final long RANK_8 = BitboardUtils.shiftNorth(RANK_7);
    public static final long[] RANK_MASKS = {RANK_1, RANK_2, RANK_3, RANK_4, RANK_5, RANK_6, RANK_7, RANK_8};

    public static final long FILE_A = 0b0000000100000001000000010000000100000001000000010000000100000001L;
    public static final long FILE_B = BitboardUtils.shiftEast(FILE_A);
    public static final long FILE_C = BitboardUtils.shiftEast(FILE_B);
    public static final long FILE_D = BitboardUtils.shiftEast(FILE_C);
    public static final long FILE_E = BitboardUtils.shiftEast(FILE_D);
    public static final long FILE_F = BitboardUtils.shiftEast(FILE_E);
    public static final long FILE_G = BitboardUtils.shiftEast(FILE_F);
    public static final long FILE_H = BitboardUtils.shiftEast(FILE_G);
    public static final long[] FILE_MASKS = {FILE_A, FILE_B, FILE_C, FILE_D, FILE_E, FILE_F, FILE_G, FILE_H};

    public static final long DIAGONAL_1 =   0x1L;
    public static final long DIAGONAL_2 =   0x102L;
    public static final long DIAGONAL_3 =   0x10204L;
    public static final long DIAGONAL_4 =   0x1020408L;
    public static final long DIAGONAL_5 =   0x102040810L;
    public static final long DIAGONAL_6 =   0x10204081020L;
    public static final long DIAGONAL_7 =   0x1020408102040L;
    public static final long DIAGONAL_8 =   0x102040810204080L;
    public static final long DIAGONAL_9 =   0x204081020408000L;
    public static final long DIAGONAL_10 =  0x408102040800000L;
    public static final long DIAGONAL_11 =  0x810204080000000L;
    public static final long DIAGONAL_12 =  0x1020408000000000L;
    public static final long DIAGONAL_13 =  0x2040800000000000L;
    public static final long DIAGONAL_14 =  0x4080000000000000L;
    public static final long DIAGONAL_15 =  0x8000000000000000L;
    public static final long[] DIAGONAL_MASKS = {
                    DIAGONAL_1, DIAGONAL_2, DIAGONAL_3, DIAGONAL_4, DIAGONAL_5, DIAGONAL_6, DIAGONAL_7, DIAGONAL_8,
                    DIAGONAL_9, DIAGONAL_10, DIAGONAL_11, DIAGONAL_12, DIAGONAL_13, DIAGONAL_14, DIAGONAL_15
            };

    public static final long ANTI_DIAGONAL_MASK_1 =   0x80L;
    public static final long ANTI_DIAGONAL_MASK_2 =   0x8040L;
    public static final long ANTI_DIAGONAL_MASK_3 =   0x804020L;
    public static final long ANTI_DIAGONAL_MASK_4 =   0x80402010L;
    public static final long ANTI_DIAGONAL_MASK_5 =   0x8040201008L;
    public static final long ANTI_DIAGONAL_MASK_6 =   0x804020100804L;
    public static final long ANTI_DIAGONAL_MASK_7 =   0x80402010080402L;
    public static final long ANTI_DIAGONAL_MASK_8 =   0x8040201008040201L;
    public static final long ANTI_DIAGONAL_MASK_9 =   0x4020100804020100L;
    public static final long ANTI_DIAGONAL_MASK_10 =  0x2010080402010000L;
    public static final long ANTI_DIAGONAL_MASK_11 =  0x1008040201000000L;
    public static final long ANTI_DIAGONAL_MASK_12 =  0x804020100000000L;
    public static final long ANTI_DIAGONAL_MASK_13 =  0x402010000000000L;
    public static final long ANTI_DIAGONAL_MASK_14 =  0x201000000000000L;
    public static final long ANTI_DIAGONAL_MASK_15 =  0x100000000000000L;
    public static final long[] ANTI_DIAGONAL_MASKS = {
                    ANTI_DIAGONAL_MASK_1, ANTI_DIAGONAL_MASK_2, ANTI_DIAGONAL_MASK_3, ANTI_DIAGONAL_MASK_4, ANTI_DIAGONAL_MASK_5,
                    ANTI_DIAGONAL_MASK_6, ANTI_DIAGONAL_MASK_7, ANTI_DIAGONAL_MASK_8, ANTI_DIAGONAL_MASK_9, ANTI_DIAGONAL_MASK_10,
                    ANTI_DIAGONAL_MASK_11, ANTI_DIAGONAL_MASK_12, ANTI_DIAGONAL_MASK_13, ANTI_DIAGONAL_MASK_14, ANTI_DIAGONAL_MASK_15
            };

    public static final long KINGSIDE_MASK = FILE_F | FILE_G | FILE_H;
    public static final long QUEENSIDE_MASK = FILE_A | FILE_B | FILE_C;

    // Masks for the squares that must be unoccupied for legal castling
    public static final long WHITE_QUEENSIDE_CASTLE_TRAVEL_MASK = 0x000000000000000EL;
    public static final long WHITE_KINGSIDE_CASTLE_TRAVEL_MASK = 0x0000000000000060L;
    public static final long BLACK_QUEENSIDE_CASTLE_TRAVEL_MASK = WHITE_QUEENSIDE_CASTLE_TRAVEL_MASK << (7 * 8);
    public static final long BLACK_KINGSIDE_CASTLE_TRAVEL_MASK = WHITE_KINGSIDE_CASTLE_TRAVEL_MASK  << (7 * 8);

    // Masks for the squares that must not be attacked for legal castling
    public static final long WHITE_QUEENSIDE_CASTLE_SAFE_MASK = 0x000000000000001CL;
    public static final long WHITE_KINGSIDE_CASTLE_SAFE_MASK = WHITE_QUEENSIDE_CASTLE_SAFE_MASK << 2;
    public static final long BLACK_QUEENSIDE_CASTLE_SAFE_MASK = WHITE_QUEENSIDE_CASTLE_SAFE_MASK << (7 * 8);
    public static final long BLACK_KINGSIDE_CASTLE_SAFE_MASK = WHITE_KINGSIDE_CASTLE_SAFE_MASK  << (7 * 8);

    // Starting positions for the white pieces
    public static final long WHITE_PAWNS_START = 0b0000000000000000000000000000000000000000000000001111111100000000L;
    public static final long WHITE_KNIGHTS_START = 0b0000000000000000000000000000000000000000000000000000000001000010L;
    public static final long WHITE_BISHOPS_START = 0b0000000000000000000000000000000000000000000000000000000000100100L;
    public static final long WHITE_ROOKS_START = 0b0000000000000000000000000000000000000000000000000000000010000001L;
    public static final long WHITE_QUEENS_START = 0b0000000000000000000000000000000000000000000000000000000000001000L;
    public static final long WHITE_KING_START = 0b0000000000000000000000000000000000000000000000000000000000010000L;

    // Starting positions for the black pieces
    public static final long BLACK_PAWNS_START = 0b0000000011111111000000000000000000000000000000000000000000000000L;
    public static final long BLACK_KNIGHTS_START = 0b0100001000000000000000000000000000000000000000000000000000000000L;
    public static final long BLACK_BISHOPS_START = 0b0010010000000000000000000000000000000000000000000000000000000000L;
    public static final long BLACK_ROOKS_START = 0b1000000100000000000000000000000000000000000000000000000000000000L;
    public static final long BLACK_QUEENS_START = 0b0000100000000000000000000000000000000000000000000000000000000000L;
    public static final long BLACK_KING_START = 0b0001000000000000000000000000000000000000000000000000000000000000L;

    public static final long[] KNIGHT_ATTACKS = new long[] {
            0x0000000000020400L, 0x0000000000050800L, 0x00000000000a1100L, 0x0000000000142200L,
            0x0000000000284400L, 0x0000000000508800L, 0x0000000000a01000L, 0x0000000000402000L,
            0x0000000002040004L, 0x0000000005080008L, 0x000000000a110011L, 0x0000000014220022L,
            0x0000000028440044L, 0x0000000050880088L, 0x00000000a0100010L, 0x0000000040200020L,
            0x0000000204000402L, 0x0000000508000805L, 0x0000000a1100110aL, 0x0000001422002214L,
            0x0000002844004428L, 0x0000005088008850L, 0x000000a0100010a0L, 0x0000004020002040L,
            0x0000020400040200L, 0x0000050800080500L, 0x00000a1100110a00L, 0x0000142200221400L,
            0x0000284400442800L, 0x0000508800885000L, 0x0000a0100010a000L, 0x0000402000204000L,
            0x0002040004020000L, 0x0005080008050000L, 0x000a1100110a0000L, 0x0014220022140000L,
            0x0028440044280000L, 0x0050880088500000L, 0x00a0100010a00000L, 0x0040200020400000L,
            0x0204000402000000L, 0x0508000805000000L, 0x0a1100110a000000L, 0x1422002214000000L,
            0x2844004428000000L, 0x5088008850000000L, 0xa0100010a0000000L, 0x4020002040000000L,
            0x0400040200000000L, 0x0800080500000000L, 0x1100110a00000000L, 0x2200221400000000L,
            0x4400442800000000L, 0x8800885000000000L, 0x100010a000000000L, 0x2000204000000000L,
            0x0004020000000000L, 0x0008050000000000L, 0x00110a0000000000L, 0x0022140000000000L,
            0x0044280000000000L, 0x0088500000000000L, 0x0010a00000000000L, 0x0020400000000000L
    };

    public static final long[] KING_ATTACKS = new long[] {
            0x0000000000000302L, 0x0000000000000705L, 0x0000000000000e0aL, 0x0000000000001c14L,
            0x0000000000003828L, 0x0000000000007050L, 0x000000000000e0a0L, 0x000000000000c040L,
            0x0000000000030203L, 0x0000000000070507L, 0x00000000000e0a0eL, 0x00000000001c141cL,
            0x0000000000382838L, 0x0000000000705070L, 0x0000000000e0a0e0L, 0x0000000000c040c0L,
            0x0000000003020300L, 0x0000000007050700L, 0x000000000e0a0e00L, 0x000000001c141c00L,
            0x0000000038283800L, 0x0000000070507000L, 0x00000000e0a0e000L, 0x00000000c040c000L,
            0x0000000302030000L, 0x0000000705070000L, 0x0000000e0a0e0000L, 0x0000001c141c0000L,
            0x0000003828380000L, 0x0000007050700000L, 0x000000e0a0e00000L, 0x000000c040c00000L,
            0x0000030203000000L, 0x0000070507000000L, 0x00000e0a0e000000L, 0x00001c141c000000L,
            0x0000382838000000L, 0x0000705070000000L, 0x0000e0a0e0000000L, 0x0000c040c0000000L,
            0x0003020300000000L, 0x0007050700000000L, 0x000e0a0e00000000L, 0x001c141c00000000L,
            0x0038283800000000L, 0x0070507000000000L, 0x00e0a0e000000000L, 0x00c040c000000000L,
            0x0302030000000000L, 0x0705070000000000L, 0x0e0a0e0000000000L, 0x1c141c0000000000L,
            0x3828380000000000L, 0x7050700000000000L, 0xe0a0e00000000000L, 0xc040c00000000000L,
            0x0203000000000000L, 0x0507000000000000L, 0x0a0e000000000000L, 0x141c000000000000L,
            0x2838000000000000L, 0x5070000000000000L, 0xa0e0000000000000L, 0x40c0000000000000L
    };

}
